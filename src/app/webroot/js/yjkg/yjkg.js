var i=1,timer=null,oldP=1,total=0,yearArr=[];function getData(t){$.ajax({url:"/ajaxapp/getNewsList",type:"POST",async:!1,dataType:"json",data:{id:13,pageIndex:t,pageSize:4,sort:"pubdate"}}).done(function(t){total=t.allcount;var i="";$wlen=$(".nmt_wrapper").width(),$w=Math.floor($wlen/272.5),$(".nmt_wrapper").width($wlen+1090),$.each(t.data,function(t,a){var e=subTime(a.pubdate,0,4),n=!1;_.includes(yearArr,e)||(n=!0,yearArr.push(e)),i+='<div class="newcon_move_text_item newcon_move_text_item'+(t+1)+'"><div class="nmticc_wrapper nmticc_wrapper'+($w+1+t)+' active"><div class="ehtmark"><div class="ehtmark_circle"></div><div class="ehtmark_line"><div class="ehtmark_line_line"></div></div></div><div class="cent"><span class="goDe"><a href="/index/detail?id='+a.id+'" title="" target="_blank">'+a.body+'</a></span><span style="height: auto;" class="timeSpan timeSpan'+(t+1)+'">'+(n?date("Y年m月",a.pubdate):date("m月",a.pubdate))+"</span></div></div></div>"}),$(".nmt_wrapper").append(i)}).fail(function(t){layer.msg("服务器内部错误!")}).always(function(){console.log("always")})}$(function(){getData(oldP),$(".tabClickEN").on("click",function(t){t.preventDefault();var a=$(this).attr("data-id");$(".tabClickEN").removeClass("active"),$(".tabClickEN"+a).addClass("active"),$(".news_dsj"+a).fadeIn("slow",function(){}),$(".news_dsj:not(.news_dsj"+a+")").hide()}),$(".newcon_move_left_circel").on("click",function(t){t.preventDefault();var s=$(this).attr("data-t");"next"===s&&oldP<total/4&&getData(++oldP),setTimeout(function(){var t,a,e=$(".nmt_wrapper").width(),n=document.getElementById("nmt_wrapper").offsetLeft,r=4*i+1;"next"===s?e>Math.abs(n)+1090?($(".nmt_wrapper").animate({left:0-(Math.abs(n)+1090)+"px"},"fast"),$(".nmticc_wrapper").animate({top:"500px"},"fast"),a=r,timer=setInterval(function(){$(".nmticc_wrapper"+a).animate({top:"0px"},"fast"),4*i<++a&&clearInterval(timer)},100),i++):layer.msg("没有更多数据了！"):0!==n?($(".nmt_wrapper").animate({left:0-(Math.abs(n)-1090)+"px"},"fast"),$(".nmticc_wrapper").animate({top:"500px"},"fast"),t=r-=5,timer=setInterval(function(){$(".nmticc_wrapper"+t).animate({top:"0px"},"fast"),--t<4*(i-1)+1&&clearInterval(timer)},100),i--):layer.msg("该页为最新数据！")},20)})});